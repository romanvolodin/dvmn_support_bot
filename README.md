# dvmn_support_bot

## Требования

Для работы с Dialogflow понадобится:

- Создайть проект в Google Cloud и сохранить его id. Подробнее [здесь](https://cloud.google.com/dialogflow/es/docs/quick/setup#project).
- Создайте "агента", который будет отвечать на вопросы. При создания агента понадобится ввести id проекта из предыдущего пункта. Укажите язык агента "русский", иначе он вас не поймет. Подробнее [здесь](https://cloud.google.com/dialogflow/es/docs/quick/build-agent).
- Зарегистрируйте сервисный аккаунт для проекта и скачайте JSON-ключ. Подробнее [здесь](https://cloud.google.com/docs/authentication/getting-started).

## Переменные окружения

Настройки берутся из переменных окружения. Чтобы их определить, создайте файл `.env` в корне проекта и запишите туда данные в таком формате: `ПЕРЕМЕННАЯ=значение`.

Доступные переменные:

- `DIALOGFLOW_PROJECT_ID` — id проекта в Google Cloud, указанный при создании агента.
- `GOOGLE_APPLICATION_CREDENTIALS` — путь до файла с ключами для подключения к Google API.

Пример:

```env
DIALOGFLOW_PROJECT_ID=example-project-157495
GOOGLE_APPLICATION_CREDENTIALS=/path/to/example-project-157495-32834a814fa6.json
```

## Обучаем бота

Чтобы бот умел отвечать на вопросы по разным темам, его надо обучить.

Создайте json-файл с вопросами и ответами по следующей схеме:

```json
{
    "Тема": {
        "questions": [
            "Вопрос 1",
            "Вопрос 2"
        ],
        "answer": "Ответ"
    },
    ...
}
```

Пример:

```json
{
    "Устройство на работу": {
        "questions": [
            "Как устроиться к вам на работу?",
            "Как работать у вас?",
            "Хочу работать у вас"
        ],
        "answer": "Если вы хотите устроиться к нам, напишите на почту."
    },
    "Забыл пароль": {
        "questions": [
            "Не помню пароль",
            "Не могу войти",
            "Проблемы со входом"
        ],
        "answer": "Если вы не можете войти на сайт, воспользуйтесь кнопкой «Забыли пароль?»"
    }
}
```

Запустите скрипт, чтобы обучить агента:

```bash
python dialogflow.py /path/to/questions.json 
```

В случае успешного выполнения скрипт ничего не выводит.

Создаем новую группу в VK. В групее, в меню справа находим пункт **Управление**, затем **Работа с API**, и создаем ключ доступа.
Далее идем **Сообщения ⟶ Настройки для бота** и включаем "Возможности ботов".
